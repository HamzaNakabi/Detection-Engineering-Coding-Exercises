title: Suspicious PowerShell Encoded Command
id: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
status: experimental
description: Detects PowerShell with encoded command execution
author: Detection Engineering
date: 2025/01/30
references:
    - https://attack.mitre.org/techniques/T1059/001/
logsource:
    product: windows
    service: powershell
detection:
    selection:
        CommandLine|contains:
            - 'EncodedCommand'
            - '-enc'
            - '-e '
            - 'bypass'
            - 'hidden'
            - 'noprofile'
    condition: selection
falsepositives:
    - Legitimate admin scripts
level: high
tags:
    - attack.execution
    - attack.t1059.001
---
title: Mimikatz Execution
id: 2b3c4d5e-6f7a-8b9c-0d1e-2f3a4b5c6d7e
status: experimental
description: Detects Mimikatz execution via command line
author: Detection Engineering
date: 2025/01/30
logsource:
    category: process_creation
    product: windows
detection:
    selection_name:
        Image|endswith:
            - '\mimikatz.exe'
            - '\mimi.exe'
    selection_args:
        CommandLine|contains:
            - 'sekurlsa'
            - 'kerberos::list'
            - 'lsadump'
            - 'privilege::debug'
    condition: selection_name or selection_args
falsepositives:
    - Legitimate penetration testing
level: critical
tags:
    - attack.credential_access
    - attack.t1003.001
---
title: Suspicious Network Tool Execution
id: 3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f
status: experimental
description: Detects execution of network reconnaissance or tunneling tools
author: Detection Engineering
date: 2025/01/30
logsource:
    category: process_creation
    product: linux
detection:
    selection:
        Image|endswith:
            - '/nmap'
            - '/masscan'
            - '/nc'
            - '/ncat'
            - '/netcat'
            - '/socat'
    condition: selection
falsepositives:
    - Legitimate network administration
level: medium
tags:
    - attack.discovery
    - attack.t1046
---
title: AWS Console Login Without MFA
id: 4d5e6f7a-8b9c-0d1e-2f3a-4b5c6d7e8f9a
status: experimental
description: Detects AWS console login without multi-factor authentication
author: Detection Engineering
date: 2025/01/30
logsource:
    product: aws
    service: cloudtrail
detection:
    selection:
        eventSource: signin.amazonaws.com
        eventName: ConsoleLogin
        responseElements.ConsoleLogin: Success
    filter:
        additionalEventData.MFAUsed: 'Yes'
    condition: selection and not filter
falsepositives:
    - Break glass accounts
    - Service accounts (should not use console)
level: high
tags:
    - attack.initial_access
    - attack.t1078.004
---
title: SSH Brute Force Attempt
id: 5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b
status: experimental
description: Multiple failed SSH authentication attempts from single source
author: Detection Engineering
date: 2025/01/30
logsource:
    product: linux
    service: auth
detection:
    selection:
        event_type: ssh_login_failed
    condition: selection | count(source_ip) by source_ip > 5
    timeframe: 5m
falsepositives:
    - Misconfigured automation
    - Password rotation scripts
level: high
tags:
    - attack.credential_access
    - attack.t1110.001
